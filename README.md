code for Boulanger-Weill et al., in preparation 

Abstract: Accumulating sensory information over long-time scales is a critical component of most circuit computations in the brain across species. It remains poorly understood how such dynamics are implemented mechanistically at the synaptic level. Dissecting such neural circuits in vertebrates requires precise knowledge of functional neural properties and directly correlating dynamics with the underlying wiring diagram within the same individual animal. Here we combine functional calcium imaging with ultrastructural circuit reconstruction, using a visual motion accumulation task in larval zebrafish. Using connectomic reconstructions of functionally identified cells and computational modeling, we show that bilateral, interhemispheric inhibition and recurrent connectivity are prominent motives for sensory accumulation and motor decision-making within the anterior hindbrain. We also demonstrate that details of this circuitry can be obtained through a complementary method involving two-photon targeted cell-specific photo-conversion labeling of functionally identified neuronal response types. Using such datasets as ground truth, we develop a classifier algorithm allowing us to assign functional labels to any electron microscopy dataset for which calcium imaging had not been performed. The resulting feature-rich library of neuronal identities and connectomes obtained from such experiments enables us to constrain and further extend biophysically realistic network models of sensory-motor decision-making in zebrafish and provide a general blueprint for circuit dissection across vertebrate brains. 
